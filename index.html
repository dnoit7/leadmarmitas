<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador de Times ⚽</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body { background: #f3f3f3; padding: 15px; }

    .card {
        border-radius: 16px;
    }

    /* corrigindo bug no Safari iOS */
    input, select, textarea {
        font-size: 16px !important;
    }

    @media (max-width: 600px) {
        .player-item {
            display: block !important;
        }
        .player-item .input-group {
            flex-direction: column !important;
        }
        .player-item .input-group input {
            margin-bottom: 8px;
        }
    }
</style>
</head>
<body>

<div class="container">
    <h2 class="text-center mb-4 fw-bold">Gerador de Times ⚽</h2>

    <!-- IMPORTAR LISTA -->
    <div class="card p-3 mb-3">
        <h5>Importar lista de jogadores</h5>
        <textarea id="rawList" class="form-control" rows="6" placeholder="Cole a lista aqui..."></textarea>

        <button class="btn btn-primary w-100 mt-2" onclick="importList()">Importar lista</button>
        <button class="btn btn-warning w-100 mt-2" onclick="clearList()">Limpar lista</button>
    </div>

    <!-- LISTA DE JOGADORES -->
    <div class="card p-3 mb-3">
        <h5>Jogadores</h5>
        <div id="playersContainer"></div>
    </div>

    <!-- TIMES -->
    <div class="card p-3 mb-3">
        <h5>Times</h5>
        <button class="btn btn-success w-100 mb-2" onclick="generateTeams()">Gerar Times</button>
        <button class="btn btn-info w-100" onclick="copyTeamsWhatsApp()">Copiar para WhatsApp</button>

        <pre id="teamsResult" class="mt-3" style="white-space: pre-wrap;"></pre>
    </div>
</div>

<script>
let jogadores = [];

/* IMPORTAR LISTA */
function importList() {
    const rawText = document.getElementById("rawList").value;

    let lines = rawText.split("\n");

    let cleanedNames = lines.map(line => 
        line.replace(/^\s*\d+[\)\.\-]*\s*/g, "")  // remove números
            .replace(/[^\p{L}\s]/gu, "")          // remove emojis e símbolos
            .trim()
    ).filter(name => name.length > 0);

    jogadores = cleanedNames.map(n => ({ nome: n, nivel: 3 }));

    renderPlayers();
}

/* RENDERIZA OS JOGADORES */
function renderPlayers() {
    const container = document.getElementById("playersContainer");
    container.innerHTML = "";

    jogadores.forEach((j, index) => {
        const div = document.createElement("div");
        div.className = "player-item mb-2 d-flex";

        div.innerHTML = `
            <div class="input-group">
                <input type="text" class="form-control player-name" value="${j.nome}" 
                    onchange="updateName(${index}, this.value)">

                <select class="form-select player-level" onchange="updateLevel(${index}, this.value)">
                    <option value="1" ${j.nivel == 1 ? "selected" : ""}>⭐</option>
                    <option value="2" ${j.nivel == 2 ? "selected" : ""}>⭐⭐</option>
                    <option value="3" ${j.nivel == 3 ? "selected" : ""}>⭐⭐⭐</option>
                    <option value="4" ${j.nivel == 4 ? "selected" : ""}>⭐⭐⭐⭐</option>
                    <option value="5" ${j.nivel == 5 ? "selected" : ""}>⭐⭐⭐⭐⭐</option>
                </select>
            </div>
        `;

        container.appendChild(div);
    });
}

function updateName(i, value) {
    jogadores[i].nome = value;
}

function updateLevel(i, value) {
    jogadores[i].nivel = parseInt(value);
}

/* LIMPAR LISTA */
function clearList() {
    document.getElementById("rawList").value = "";
    jogadores = [];
    renderPlayers();
    document.getElementById("teamsResult").innerHTML = "";
}

/* GERAR TIMES */
function generateTeams() {

    if (jogadores.length < 2) {
        alert("Adicione pelo menos 2 jogadores!");
        return;
    }

    let copia = jogadores.map(j => ({ ...j }));

    // Ordena por nível
    copia.sort((a, b) => a.nivel - b.nivel);

    let time1 = [];
    let time2 = [];

    // Distribuir alternadamente (CORRIGIDO)
    copia.forEach((jogador, i) => {
        if (i % 2 === 0) time1.push(jogador);
        else time2.push(jogador);
    });

    let result =
        "⚽ *Time 1:*\n" + time1.map(j => j.nome).join("\n") +
        "\n\n⚽ *Time 2:*\n" + time2.map(j => j.nome).join("\n");

    document.getElementById("teamsResult").textContent = result;
}

/* COPIAR PARA WHATSAPP */
function copyTeamsWhatsApp() {
    const text = document.getElementById("teamsResult").innerText;

    navigator.clipboard.writeText(text).then(() => {
        alert("Times copiados! Agora é só colar no WhatsApp.");
    });
}
</script>

</body>
</html>
